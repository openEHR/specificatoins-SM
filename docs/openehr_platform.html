<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Platform Abstract Service Model">
<meta name="keywords" content="openehr, service, API">
<title>openEHR Platform Abstract Service Model</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_openehr_platform_abstract_service_model">openEHR Platform Abstract Service Model</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
<li><a href="#_conformance">1.5. Conformance</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_general_assumptions">2.1. General Assumptions</a></li>
<li><a href="#_openehr_platform_model">2.2. openEHR Platform Model</a></li>
<li><a href="#_interface_calls">2.3. Interface Calls</a></li>
<li><a href="#_anatomy_of_an_abstract_call_specification">2.4. Anatomy of an Abstract Call Specification</a></li>
<li><a href="#_global_conventions">2.5. Global Conventions</a>
<ul class="sectlevel3">
<li><a href="#_functional_style">2.5.1. Functional Style</a></li>
<li><a href="#_list_handling">2.5.2. List Handling</a></li>
<li><a href="#_global_naming_conventions">2.5.3. Global Naming Conventions</a></li>
</ul>
</li>
<li><a href="#_package_structure">2.6. Package Structure</a></li>
</ul>
</li>
<li><a href="#_common_package">3. Common Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">3.1. Overview</a></li>
<li><a href="#_representing_call_status">3.2. Representing Call Status</a></li>
<li><a href="#_version_update_semantics">3.3. Version Update Semantics</a></li>
<li><a href="#_class_definitions">3.4. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_status_interface">3.4.1. I_STATUS Interface</a></li>
<li><a href="#_call_status_class">3.4.2. CALL_STATUS Class</a></li>
<li><a href="#_call_status_type_enumeration">3.4.3. CALL_STATUS_TYPE Enumeration</a></li>
<li><a href="#_update_versiont_class">3.4.4. UPDATE_VERSION&lt;T&gt; Class</a></li>
<li><a href="#_update_audit_class">3.4.5. UPDATE_AUDIT Class</a></li>
<li><a href="#_i_validity_checker_interface">3.4.6. I_VALIDITY_CHECKER Interface</a></li>
<li><a href="#_validity_checker_status_enumeration">3.4.7. VALIDITY_CHECKER_STATUS Enumeration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_definition_package">4. Definition Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">4.1. Overview</a></li>
<li><a href="#_archetypes_and_templates">4.2. Archetypes and Templates</a></li>
<li><a href="#_registered_queries">4.3. Registered Queries</a></li>
<li><a href="#_class_definitions_2">4.4. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_definition_adl2_interface">4.4.1. I_DEFINITION_ADL2 Interface</a></li>
<li><a href="#_i_definition_adl14_interface">4.4.2. I_DEFINITION_ADL14 Interface</a></li>
<li><a href="#_i_definition_query_interface">4.4.3. I_DEFINITION_QUERY Interface</a></li>
<li><a href="#_definition_call_status_type_enumeration">4.4.4. DEFINITION_CALL_STATUS_TYPE Enumeration</a></li>
<li><a href="#_query_descriptor_class">4.4.5. QUERY_DESCRIPTOR Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ehr_package">5. EHR Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_4">5.1. Overview</a></li>
<li><a href="#_class_definitions_3">5.2. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_ehr_service_interface">5.2.1. I_EHR_SERVICE Interface</a></li>
<li><a href="#_i_ehr_interface">5.2.2. I_EHR Interface</a></li>
<li><a href="#_i_ehr_status_interface">5.2.3. I_EHR_STATUS Interface</a></li>
<li><a href="#_i_ehr_directory_interface">5.2.4. I_EHR_DIRECTORY Interface</a></li>
<li><a href="#_i_ehr_composition_interface">5.2.5. I_EHR_COMPOSITION Interface</a></li>
<li><a href="#_i_ehr_contribution_interface">5.2.6. I_EHR_CONTRIBUTION Interface</a></li>
<li><a href="#_ehr_summary_class">5.2.7. EHR_SUMMARY Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_demographic_package">6. Demographic Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">6.1. Overview</a></li>
<li><a href="#_class_definitions_4">6.2. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_demographic_service_interface">6.2.1. I_DEMOGRAPHIC_SERVICE Interface</a></li>
<li><a href="#_i_party_interface">6.2.2. I_PARTY Interface</a></li>
<li><a href="#_i_party_relationship_interface">6.2.3. I_PARTY_RELATIONSHIP Interface</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ehr_index_package">7. EHR Index Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_6">7.1. Overview</a></li>
<li><a href="#_class_definitions_5">7.2. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_ehr_index_interface">7.2.1. I_EHR_INDEX Interface</a></li>
<li><a href="#_resource_status_class">7.2.2. RESOURCE_STATUS Class</a></li>
<li><a href="#_resource_instance_type_enumeration">7.2.3. RESOURCE_INSTANCE_TYPE Enumeration</a></li>
<li><a href="#_location_desc_class">7.2.4. LOCATION_DESC Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_query_package">8. Query Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_7">8.1. Overview</a></li>
<li><a href="#_class_definitions_6">8.2. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_query_service_interface">8.2.1. I_QUERY_SERVICE Interface</a></li>
<li><a href="#_stored_query_execute_spec_class">8.2.2. STORED_QUERY_EXECUTE_SPEC Class</a></li>
<li><a href="#_adhoc_query_execute_spec_class">8.2.3. ADHOC_QUERY_EXECUTE_SPEC Class</a></li>
<li><a href="#_result_set_class">8.2.4. RESULT_SET Class</a></li>
<li><a href="#_result_set_column_class">8.2.5. RESULT_SET_COLUMN Class</a></li>
<li><a href="#_result_set_row_class">8.2.6. RESULT_SET_ROW Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_message_package">9. Message Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_8">9.1. Overview</a></li>
<li><a href="#_class_definitions_7">9.2. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_message_service_interface">9.2.1. I_MESSAGE_SERVICE Interface</a></li>
<li><a href="#_i_ehr_extract_service_interface">9.2.2. I_EHR_EXTRACT_SERVICE Interface</a></li>
<li><a href="#_i_tdd_service_interface">9.2.3. I_TDD_SERVICE Interface</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_admin_package">10. Admin Package</a>
<ul class="sectlevel2">
<li><a href="#_overview_9">10.1. Overview</a></li>
<li><a href="#_class_definitions_8">10.2. Class Definitions</a>
<ul class="sectlevel3">
<li><a href="#_i_admin_service_interface">10.2.1. I_ADMIN_SERVICE Interface</a></li>
<li><a href="#_i_admin_archive_interface">10.2.2. I_ADMIN_ARCHIVE Interface</a></li>
<li><a href="#_i_admin_dump_load_interface">10.2.3. I_ADMIN_DUMP_LOAD Interface</a></li>
<li><a href="#_dump_load_fail_report_class">10.2.4. DUMP_LOAD_FAIL_REPORT Class</a></li>
<li><a href="#_export_spec_class">10.2.5. EXPORT_SPEC Class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_openehr_platform_abstract_service_model" class="sect0"><a class="anchor" href="#_openehr_platform_abstract_service_model"></a>openEHR Platform Abstract Service Model</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: SM latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: TRIAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: openehr, service, API</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2017 - 2020 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/SM/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>SM Release 1.0.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.9.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adjust naming and definitions of elements in <code>RESULT_SET</code> classes to reflect REST API.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Iancu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>25 Mar 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add missing enumeration <code><em>invalid_artefact</em></code> to <code>DEFINITION_CALL_STATUS_TYPE</code> (<a href="https://specifications.openehr.org/tickets/SPECPR-293" target="_blank" rel="noopener">SPECPR-293</a>);<br>
 Add <code><em>xxx_count()</em></code> calls to <code>I_DEFINITION_XX</code> interfaces (<a href="https://specifications.openehr.org/tickets/SPECPR-288" target="_blank" rel="noopener">SPECPR-288</a>);<br>
 Rename <code><em>row_offset</em></code> and <code><em>rows_to_fetch</em></code> to <code><em>item_offset</em></code> and <code><em>items_to_fetch</em></code> (<a href="https://specifications.openehr.org/tickets/SPECPR-292" target="_blank" rel="noopener">SPECPR-292</a>);<br>
 Change names of <code><em>list_all_xxx()</em></code> functions in <code>definitions</code> interfaces to <code><em>list_xxx()</em></code> (<a href="https://specifications.openehr.org/tickets/SPECPR-292" target="_blank" rel="noopener">SPECPR-292</a>);<br>
 Added <code><em>valid_xxx()</em></code> calls and preconditions to <code><em>upload_xx()</em></code> calls in  <code>I_DEFINITION_XX</code> interfaces (<a href="https://specifications.openehr.org/tickets/SPECPR-291" target="_blank" rel="noopener">SPECPR-291</a>);<br>
 Remove duplicate operation <code>I_EHR.<em>list_contributions()</em></code> (<a href="https://specifications.openehr.org/tickets/SPECPR-304" target="_blank" rel="noopener">SPECPR-304</a>);<br>
 Improve documentation of implicit server-side Contribution and Version creation (<a href="https://specifications.openehr.org/tickets/SPECPR-305" target="_blank" rel="noopener">SPECPR-305</a>);<br>
 Correct argument types of <code>I_EHR_COMPOSITION.<em>get_composition_xx()</em></code> functions; rename <code><em>get_composition()</em></code> to <code><em>get_composition_latest()</em></code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28 Feb 2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add <code>I_DEFINITIONS_CHECKER</code> and <code>DEFINITIONS_CHECKER_STATUS</code> to support definitions validity pre-conditions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 Jan 2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improve documentation text;<br>
 Reverse order of Parameter and Errors sections in operations text.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22 Aug 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improve documentation text;<br>
 Add section on call conventions; improve query register calls based on REST API 0.9.0.<br>
 Add EHR Index section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14 Feb 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Improve documentation text;<br>
 remove <code><em>auth_tok</em></code> argument from calls.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added demographic interface calls;<br>
 added more admin interface calls.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECSM-1" target="_blank" rel="noopener">SPECSM-1</a>: Initial writing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">openEHR SEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Sep 2017</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica; openEHR Foundation Management Board.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_contributors"><a class="anchor" href="#_contributors"></a>Contributors</h3>
<div class="paragraph">
<p>This specification has benefited from formal and informal input from the openEHR and wider health informatics community. The openEHR Foundation would like to recognise the following people for their contributions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pablo Pazos, Principal, Cabloabs, Uruguay</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a registered trademark of the openEHR Foundation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document specifies core components of the openEHR platform in a formal, abstract form, for use in developing concrete service API definitions such as SOAP, REST, Google protocol buffers and other interface technologies.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Solution vendors.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/openEHR/specifications-ITS-REST" target="_blank" rel="noopener">openEHR REST APIs</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the TRIAL state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/SM/latest/openehr_platform.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://forums.openehr.org/c/specifications" target="_blank" rel="noopener">technical mailing list</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/SM/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/SM/history" target="_blank" rel="noopener">SM component Change Request tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.5. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR specification is determined by a formal test of that artifact against the relevant <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specification(s) (ITSs)</a>, such as a REST API interface or an XML-schema. Since ITSs are formal derivations from underlying models, ITS conformance indicates model conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general_assumptions"><a class="anchor" href="#_general_assumptions"></a>2.1. General Assumptions</h3>
<div class="paragraph">
<p>In order to specify concrete service interfaces (i.e. APIs) to openEHR platform product components, a formal, abstract definition of the platform interfaces is useful, so as to be able to state the formal interface call semantics independent of any particular implementation technology. This approach clarifies the distinction between required semantics and the details contingent in any concrete technology, such as SOAP/WSDL, REST, and so on, each of which has its own characteristics and rules.</p>
</div>
<div class="paragraph">
<p>It is assumed that native APIs are network-accessible via one or more communications protocols, each with an appropriate <em>protocol adapter</em>. Such protocols include the text-based, such as <a href="https://en.wikipedia.org/wiki/SOAP" target="_blank" rel="noopener">SOAP/WSDL</a> and <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener">REST</a>, as well as the many binary protocols, including <a href="https://github.com/google/protobuf/wiki" target="_blank" rel="noopener">Google Protocol Buffers</a>, <a href="https://thrift.apache.org" target="_blank" rel="noopener">Apache Thrift</a>, <a href="https://kafka.apache.org" target="_blank" rel="noopener">Kafka</a>, <a href="https://zeroc.com/products/ice#what-is-ice" target="_blank" rel="noopener">ZeroC ICE</a>, and <a href="https://www.amqp.org/" target="_blank" rel="noopener">Advanced Message Queueing Protocol (AMPQ)</a>. The focus of this specification is the nominal 'native API' that is reached by any of these methods, as shown below.</p>
</div>
<div id="assumed_model" class="imageblock text-center text-center">
<div class="content">
<img src="openehr_platform/diagrams/assumed_model.svg" alt="assumed model">
</div>
<div class="title">Figure 1. Assumed Architecture</div>
</div>
</div>
<div class="sect2">
<h3 id="_openehr_platform_model"><a class="anchor" href="#_openehr_platform_model"></a>2.2. openEHR Platform Model</h3>
<div class="paragraph">
<p>The following figure illustrates the components of the abstract openEHR Platform, along with their interfaces.</p>
</div>
<div id="platform_definition" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_definition.svg" alt="SM platform definition">
</div>
<div class="title">Figure 2. sm.openehr_platform.platform_definition Package</div>
</div>
<div class="paragraph">
<p>Each component has one or more associated interfaces, i.e. abstract service definitions which define a <em>transactional interface</em> to the service represented by the component. Each interface consists of a number of <em>calls</em>, and each call is defined in an abstract way, i.e. independent of the representations and expressions required by a concrete protocol.</p>
</div>
<div class="paragraph">
<p>This view does not attempt to define a real product architecture as would be developed by an openEHR platform implementor, but it does establish a <em>formal equivalent</em> of any such architecture. Practically, this entails standardised <em>naming</em> of components and the semantics of their logical interfaces so that platform procurers and users can unambiguously refer to the 'Admin service' or the 'EHR service' within technical or commercial documents. The abstract service architecture described here provides platform implementers a standard reference definition for mapping agreed functionality (such as requested in a tender or other solicitation) into their own architectures, which may be organised quite differently.</p>
</div>
<div class="paragraph">
<p>The services are as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service providing administrative facilities on all services in the installed environment, such as back-up.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Definitions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service enabling upload and querying of definition artefacts, including archetypes, templates and queries.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versioned persistence service for EHRs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demographic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versioned persistence service for demographic data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR Index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR id / demographic subject cross-reference service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service providing AQL query retrieval for EHR, demographics and other content services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminology</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service providing access to terminology, including intentional value sets.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message import and export service, supporting multiple message formats as we as EHR Extracts and documents.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Log</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IHE ATNA-compliant system log.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_interface_calls"><a class="anchor" href="#_interface_calls"></a>2.3. Interface Calls</h3>
<div class="paragraph">
<p>Regardless of the internal organisation of real product architectures, agreement across a community of producers and users of products that claim to <em>conform</em> to a published platform specification, must by definition be based on something formally statable and testable. As noted above, this is described here in the form of logical components which have logical interfaces, each consisting of a set of calls, of which the latter constitute the finest level of specification.</p>
</div>
<div class="paragraph">
<p>A logical interface call is understood here in the standard computer science manner, i.e. as a callable routine with a formal, typed signature. Good practice usually dictates that such routines should take the form of either pure <em>functions</em>, or pure <em>procedures</em>, but not both: side-effect producing functions should generally be avoided. In other words, interface calls are either <em>queries</em> that return something but do not change state, or <em>commands</em> that cause a change, but don&#8217;t compute or return anything. The separation is sometimes known as <em>command / query separation</em>.</p>
</div>
<div class="paragraph">
<p>The signatures of query and procedure calls thus take the following syntactic forms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    func: T                                 -- function with no arguments
    func(arg1: X, arg2: Y, arg3: Z): T      -- function with arguments

    proc                                    -- procedure with no arguments
    proc(arg1: X, arg2: Y)                  -- procedure with arguments</pre>
</div>
</div>
<div class="paragraph">
<p>One of the key assumptions of this specification (and indeed formal standardisation in general) is that although real implementations of a platform may have differently structured components and different naming of functions, arguments etc, that there is a <em>formal equivalence</em> between calls specified in a published standard and those in the implementation. Thus, it must be the case that even if three calls in an implementation are required to achieve the effect of a single call in this specification, that the conditions described here prior and after the call(s) are the same in both cases, and also that the three calls taken together are transactionally protected. If this is not true, it implies that the implementation is introducing unspecified semantics.</p>
</div>
</div>
<div class="sect2">
<h3 id="_anatomy_of_an_abstract_call_specification"><a class="anchor" href="#_anatomy_of_an_abstract_call_specification"></a>2.4. Anatomy of an Abstract Call Specification</h3>
<div class="paragraph">
<p>A fuller specification of any function or procedure includes its semantics, stated in terms of pre-conditions, post-conditions and exceptions, along with  documentation of the same. This is exactly as found in any standard library in most programming languages, and indeed, standardised meta-data keywords and labelling have evolved in most programming documentation systems to support exactly this kind of specification, even where the language doesn&#8217;t directly support some of its features, such as pre- or post-conditions.</p>
</div>
<div class="paragraph">
<p>This specification uses the same form of specification, which can be illustrated as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 57.1429%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Call</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>create_ehr_with_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This call creates a new EHR in the EHR persistence service, with &#8230;&#8203;.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Arguments</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>an_id</code>: <code>UUID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A UUID that will be used as the EHR&#8217;s <code><em>ehr_id</em></code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Pre-conditions</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid_id: <code>not has_ehr (an_id)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No EHR with <code><em>ehr_id</em> = <em>an_id</em></code> currently exists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Post-conditions</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ehr_created: <code>has_ehr (an_id)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An EHR with <code><em>ehr_id</em> = <em>an_id</em></code> has been created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><em>Exceptions</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Ehr_already_exists</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR with <code><em>an_id</em></code> already exists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Auth_error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caller authorisation failure.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The above kind of specification can in general be easily mapped to any concrete API technology. In each case, how the arguments are expressed, details of serialisation (for text-based technologies like SOAP and REST), error handling, etc, will be different. Google protocol buffers for example uses an OMG IDL-like approach to specification, i.e. structured type definitions. REST on the other hand is a web-based type of API normally mapped onto HTTP verbs, URIs and HTTP error codes.</p>
</div>
<div class="paragraph">
<p>The intent of the current specification is thus to express the abstract element of each interface call, so that both back-end semantics can be correctly designed, and API definitions can be correctly written and tested.</p>
</div>
</div>
<div class="sect2">
<h3 id="_global_conventions"><a class="anchor" href="#_global_conventions"></a>2.5. Global Conventions</h3>
<div class="sect3">
<h4 id="_functional_style"><a class="anchor" href="#_functional_style"></a>2.5.1. Functional Style</h4>
<div class="paragraph">
<p>Various ways of expressing service interface functions to underlying resources are possible, with choices available in various dimensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stateless / mostly stateless / stateless;</p>
</li>
<li>
<p>approach to access control and authorisation;</p>
</li>
<li>
<p>single interface / composed interface ;</p>
</li>
<li>
<p>full argument lists / parameter-carrying object arguments / mixture.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In real implementations, different choices will be made; all that matters is that the implementation contains one or more calls that can be made for each call documented here, with the same transactional semantics. Consequently, the functional style used in this specification does not need to be exactly replicated in either a back-end or an API, only the resulting semantics do.</p>
</div>
<div class="paragraph">
<p>Here we use a <em>nearly</em> stateless approach, where the exception is to use a second call to determine success status and any error information. This can easily be mapped to a fully stateless style, as would be used in a server driven by a managed request queue. This approach enables functions to be declared in a standard programming style, with return types reflecting successful execution. The function declarations are accordingly of the following style:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="idl"><span></span><span class="tok-o">//</span> definition

interface I_EHR_SERVICE <span class="tok-o">:</span> I_STATUS {
    Boolean has_ehr(UUID an_ehr_id);
    UUID create_ehr();
    UUID create_ehr_with_id(UUID an_ehr_id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Authentication and authorisation is assumed to have been dealt with before any particular call has been made by a combination of standard authentication technologies (e.g. OAuth, RFC 7235) and role-based access control.</p>
</div>
<div class="paragraph">
<p>Failures are dealt with by calling a standard function <code>last_call_failed()</code> and if <code>True</code>, calling <code>last_call_status()</code> which returns a structured error object. This enables the recording of errors (such as authorisation failure), pre-condition exceptions (generally relating to argument vaidity) and server exceptions (equivalent to post-condition or invariant exceptions). This leads to the following typical call sequence for calls defined in this specification.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">I_EHR_SERVICE</span> <span class="tok-n">i_ehr_service</span><span class="tok-o">;</span>
<span class="tok-n">CALL_STATUS</span> <span class="tok-n">call_status</span><span class="tok-o">;</span>
<span class="tok-n">UUID</span> <span class="tok-n">test_result</span><span class="tok-o">,</span> <span class="tok-n">result</span><span class="tok-o">,</span> <span class="tok-n">an_ehr_id</span><span class="tok-o">;</span>

<span class="tok-k">try</span> <span class="tok-o">{</span>
    <span class="tok-n">test_result</span> <span class="tok-o">=</span> <span class="tok-n">i_ehr_service</span><span class="tok-o">.</span><span class="tok-na">create_ehr_with_id</span><span class="tok-o">(</span><span class="tok-n">an_ehr_id</span><span class="tok-o">);</span>
    <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">i_ehr_service</span><span class="tok-o">.</span><span class="tok-na">last_call_error</span><span class="tok-o">())</span>
        <span class="tok-n">call_status</span> <span class="tok-o">=</span> <span class="tok-n">i_ehr_service</span><span class="tok-o">.</span><span class="tok-na">last_call_status</span><span class="tok-o">();</span>
    <span class="tok-k">else</span>
        <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">test_result</span><span class="tok-o">;</span>
<span class="tok-o">}</span>
<span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">PreConditionException</span> <span class="tok-n">e</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-c1">// deal with pre-condition violations</span>

    <span class="tok-n">call_status</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">CallStatus</span><span class="tok-o">(</span><span class="tok-n">CallStatuses</span><span class="tok-o">.</span><span class="tok-na">precondition_violation</span><span class="tok-o">)</span>
    <span class="tok-c1">// set any other information</span>
<span class="tok-o">}</span>
<span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">Exception</span> <span class="tok-n">e</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-c1">// deal with other exceptions</span>

    <span class="tok-n">call_status</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">CallStatus</span><span class="tok-o">(</span><span class="tok-n">CallStatuses</span><span class="tok-o">.</span><span class="tok-na">exception</span><span class="tok-o">)</span>
    <span class="tok-c1">// set any other information</span>
<span class="tok-o">}</span>


<span class="tok-c1">// package up call_status, result in response</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Apart from error-handling, the interfaces are stateless in the sense that any single call constitutes a self-standing transaction on the back-end service, i.e. a transaction that when executed on the service will leave it in a consistent state.</p>
</div>
<div class="paragraph">
<p>The above illustrates just one pattern of calling in a server. Another common style is to include results as 'out' parameters, and to use the return value to return call status. Either style can be used, and can be trivially mapped from one to the other. No such code is intended to implemented directly; the above is merely a way of explaining the semantics within context of the interface calls documented in this specification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_list_handling"><a class="anchor" href="#_list_handling"></a>2.5.2. List Handling</h4>
<div class="paragraph">
<p>Calls that produce a container result potentially containing unlimited numbers of elements can be managed in a typical 'DB cursor' fashion, i.e. by setting the following parameters:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>item_offset</code></dt>
<dd>
<p>Optional parameter specifying offset in query result items to at which to start returning items, starting at zero. An offset of 1 means that the first item to return is the 2nd item.  Zero signifies that items starting from the first item should be returned.</p>
</dd>
<dt class="hdlist1"><code>items_to_fetch</code></dt>
<dd>
<p>Optional parameter specifying number of result items to fetch, starting from the item indicated by <code>item_offset</code>. A zero means 'all'.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_global_naming_conventions"><a class="anchor" href="#_global_naming_conventions"></a>2.5.3. Global Naming Conventions</h4>
<div class="paragraph">
<p>The following naming conventions are used for naming parameters throughout this specification, where they apply.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>ehr_id</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value for an EHR identifier, stored under <code>EHR.<em>ehr_id.value</em></code>, usually an UUID or GUID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>versioned_object_uid</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of a <code>VERSIONED_OBJECT</code> unique identifier, i.e. <code>VERSIONED_OBJECT.<em>uid.value</em></code>,<br>
                            e.g. <code>8849182c-82ad-4088-a07f-48ead4180515</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>version_uid</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of a <code>VERSION</code> unique identifier, i.e. <code>VERSION.<em>uid.value</em></code>,<br>
                             e.g. <code>8849182c-82ad-4088-a07f-48ead4180515::example.domain.com::2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>preceding_version_uid</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of a previous <code>VERSION</code> unique identifier,<br>
                             e.g. <code>8849182c-82ad-4088-a07f-48ead4180515::example.domain.com::1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>object_id</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A placeholder for either <code><em>versioned_object_uid</em></code> or <code><em>version_uid</em></code> identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>time</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A date-time in ISO 8601 format (e.g. <code>2015-01-20T19:30:22.765+01:00</code>)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_package_structure"><a class="anchor" href="#_package_structure"></a>2.6. Package Structure</h3>
<div class="paragraph">
<p>The openEHR Platform Service Model package structure is illustrated below. It consists of two outer packages, <code>platform_definition</code> and <code>platform_interface</code>. The former contains the service components, while the latter contains the interfaces attached to each service component.</p>
</div>
<div id="platform_packages" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform-packages.svg" alt="SM platform packages">
</div>
<div class="title">Figure 3. sm.openehr_platform Package Overview</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_common_package"><a class="anchor" href="#_common_package"></a>3. Common Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>3.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.common</code> package shown below defines common elements of the platform service model. The key elements are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_STATUS</code> / <code>CALL_STATUS</code>: a representation of the status result of any call execution;</p>
</li>
<li>
<p><code>UPDATE_VERSION</code>: an information structure suitable for committing data to a versioned store based on the <a href="https://specifications.openehr.org/releases/RM/latest/common.html" target="_blank" rel="noopener">openEHR versioning (change control) specification</a>;</p>
</li>
<li>
<p><code>PLATFORM_SERVICE</code>: an enumeration of the available services, used in various interfaces.</p>
</li>
</ul>
</div>
<div id="sm_platform_interface_common" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.common.svg" alt="SM platform interface.common">
</div>
<div class="title">Figure 4. <code>sm.openehr_platform.platform_interface.common</code> package</div>
</div>
</div>
<div class="sect2">
<h3 id="_representing_call_status"><a class="anchor" href="#_representing_call_status"></a>3.2. Representing Call Status</h3>
<div class="paragraph">
<p>The status of a call is represented using a <code>CALL_STATUS</code> object containing various informational fields and a <code><em>code</em></code> attribute that carries a value from the enumerated type <code>CALL_STATUS_TYPE</code> or a descendant. The codes defined in <code>CALL_STATUS_TYPE</code> are generic and apply across all services. Particular services may add more codes by inheriting from this class and defining further specific codes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_version_update_semantics"><a class="anchor" href="#_version_update_semantics"></a>3.3. Version Update Semantics</h3>
<div class="paragraph">
<p>Some of the interfaces defined in this specification cause creation or update of a versioned 'top-level' openEHR object, i.e. a <code>COMPOSITION</code>, <code>PARTY</code> or similar. Such calls implicitly require the creation of a new <code>CONTRIBUTION</code> on the server side, as well as one or more new <code>ORIGINAL_VERSION</code> objects, and in creation cases, new <code>VERSIONED_OBJECTS</code>.</p>
</div>
<div class="paragraph">
<p>To perform this work on the server, the <code>UPDATE_VERSION&lt;T&gt;</code> structure is provided in order to enable the appropriate meta-data to be supplied by the caller, leaving out parts that are generated by the service. Thus, a partial version of <code>AUDIT_DETAILS</code> called <code>UPDATE_AUDIT</code> is used, since the <code><em>time_committed</em></code> and <code><em>system_id</em></code> attributes need to be generated on the server. <code>ATTESTATION</code> instances can be supplied in their full form.</p>
</div>
<div class="paragraph">
<p>The <code><em>preceding_version_uid</em></code> attribute must be specified, except in the case where the version update is a first version. The <code><em>lifecycle_state</em></code> must be supplied in all cases, which is a value such as <code>532|complete|</code>, <code>553|incomplete|</code>, <code>523|deleted|</code>, etc from the <a href="https://github.com/openEHR/terminology" target="_blank" rel="noopener">openEHR terminology</a>.</p>
</div>
<div class="paragraph">
<p>This approach allows the server side to create the required new <code>ORIGINAL_VERSION&lt;T&gt;</code> object, rather than the client trying to do it.</p>
</div>
<div class="paragraph">
<p>For each storable top-level type such as <code>COMPOSITION</code>, <code>FOLDER</code>, <code>PARTY</code> descendants etc, a new concrete type may be derived from <code>UPDATE_VERSION&lt;T&gt;</code>. For example, for <code>COMPOSITION</code>, the type <code>UV_COMPOSITION</code> may be defined, inheriting from <code>UPDATE_VERSION&lt;COMPOSITION&gt;</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions"><a class="anchor" href="#_class_definitions"></a>3.4. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_status_interface"><a class="anchor" href="#_i_status_interface"></a>3.4.1. I_STATUS Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_STATUS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface to obtain status of previous calls; use by inheritance.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>last_call_failed</strong> (): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if the last call generated an error, i.e. any result other than <code>CALL_STATUSES.<em>success</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>last_call_status</strong> (): <code>CALL_STATUS</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Class status object for last call.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_call_status_class"><a class="anchor" href="#_call_status_class"></a>3.4.2. CALL_STATUS Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALL_STATUS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Object representing a call status.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>code</strong>: <code>CALL_STATUS_TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Call status code for last call.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>call_name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of call that this status documents.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>call_string</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Full call, in stringified form, including arguments. Non-primitive objects are shown as addresses unless an exported as_string() method is available.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>meaning</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Meaning of the result status.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>message</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Error message text.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_call_status_type_enumeration"><a class="anchor" href="#_call_status_type_enumeration"></a>3.4.3. CALL_STATUS_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALL_STATUS_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Enumeration representing standard call statuses.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">success</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Call succeeded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">auth_failure</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Authorisation failure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">precondition_violation</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Precondition violation occurred.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">object_version_does_not_exist</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Referenced Object version of a Versioned Object does not exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">versioned_object_does_not_exist</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No Versioned Object with referenced identifier found.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">exception</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Exception other than precondition violation occurred.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">ehr_id_does_not_exist</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Ehr provided id not found.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">party_id_does_not_exist</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Party with provided id not found.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">file_not_writable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>File system locator cannot be written to.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">version_mismatch</p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_versiont_class"><a class="anchor" href="#_update_versiont_class"></a>3.4.4. UPDATE_VERSION&lt;T&gt; Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>UPDATE_VERSION&lt;T&gt; (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>An object representing an update to an existing <code>VERSION</code> within a <code>VERSIONED_OBJECT</code>, that can be provided by a client to the platform. The back-end will construct a full <code>VERSION&lt;T&gt;</code> object from this and server-side generated data items. If this represents the first version, it will also construct a new <code>VERSIONED_OBJECT</code> first.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preceding_version_uid</strong>: <code>OBJECT_VERSION_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Current version in service for which this version is an update (i.e. the version that is preceding relative to this version update).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>Terminology_code</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Lifecycle state of the content item in this version.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>attestations</strong>: <code>List&lt;ATTESTATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set of attestations relating to this version.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>data</strong>: <code>T</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Data item being provided in this Version update. Must conform in type to the expected type, which is normally constrained using a derivative class like <code>VU_XX</code> that binds T to a particular type such as <code>COMPOSITION</code> etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>audit</strong>: <code>UPDATE_AUDIT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Audit details for this update.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_audit_class"><a class="anchor" href="#_update_audit_class"></a>3.4.5. UPDATE_AUDIT Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>UPDATE_AUDIT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>The set of attributes required to document the committal of an information item to a repository. Used by the server to create an <code>AUDIT_DETAILS</code> object.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>change_type</strong>: <code>Terminology_code</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Type of change. Coded using the openEHR Terminology  audit change type  group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Reason for committal.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>committer</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Identity and optional reference into identity management service, of user who committed the item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p><em>Change_type_valid</em>: <code>terminology (Terminology_id_openehr).has_code_for_group_id (Group_id_audit_change_type, change_type.defining_code)</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_validity_checker_interface"><a class="anchor" href="#_i_validity_checker_interface"></a>3.4.6. I_VALIDITY_CHECKER Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_VALIDITY_CHECKER</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Utility functions for checking validity of use of definitions within data.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definitions_valid</strong> (<br>
a_content: <code>LOCATABLE[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return <code>True</code> if the definition identifiers (i.e. archetype and template identifiers) are known in the local <code>definitions</code> service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>content_valid</strong> (<br>
a_content: <code>LOCATABLE[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return <code>True</code> if the content structure is a valid instance of the relevant RM classes.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_validity_checker_status_enumeration"><a class="anchor" href="#_validity_checker_status_enumeration"></a>3.4.7. VALIDITY_CHECKER_STATUS Enumeration</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>VALIDITY_CHECKER_STATUS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Enumeration representing <code>I_DEFINITIONS_CHECKER</code> statuses.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">definition_unknown</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The content object contains definition identifiers not known in the local <code>definitions</code> service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">content_invalid</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The content object is not a valid instance of its reference model classes.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_definition_package"><a class="anchor" href="#_definition_package"></a>4. Definition Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.definitions</code> package shown below defines service interface to the <code>definitions</code> component in the logical platform architecture.</p>
</div>
<div id="sm_platform_interface_definitions" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.definitions.svg" alt="SM platform interface.definitions">
</div>
<div class="title">Figure 5. <code>sm.openehr_platform.platform_interface.definitions</code> package</div>
</div>
<div class="paragraph">
<p>The interfaces provided in this service are designed to enable any model-like or reference artefacts, other than terminology, to be stored for use by the rest of the system. This includes archetypes, templates, queries, and query sets.</p>
</div>
</div>
<div class="sect2">
<h3 id="_archetypes_and_templates"><a class="anchor" href="#_archetypes_and_templates"></a>4.2. Archetypes and Templates</h3>
<div class="paragraph">
<p>The <code>I_DEFINITION_ADL14</code> and <code>I_DEFINITION_ADL2</code> interfaces are provided to enable upload, updating and removal of archetypes and templates based on the <a href="https://specifications.openehr.org/releases/AM/latest/index" target="_blank" rel="noopener">ADL 1.4 and ADL 2 standards</a> respectively, for use in an operational system.</p>
</div>
<div class="paragraph">
<p>In the ADL2 case, archetypes and 'templates' are all instances of archetypes, formally speaking, which means that both source artefacts and Operational Templates (OPTs) can be uploaded. All such artefacts are identified in the same way, via an Archetype human-readable identifier (<code>ARCHETYPE_HRID</code>) and a UUID.</p>
</div>
<div class="paragraph">
<p>For ADL 1.4, 'templates' are distinct artefacts, and the service enables the upload of source archetypes and ADL 1.4 - based OPTs, which are XML artefacts. In ADL 1.4, archetypes are identified with the older <code>ARCHETYPE_ID</code>, while OPTs are identified with UUIDs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_registered_queries"><a class="anchor" href="#_registered_queries"></a>4.3. Registered Queries</h3>
<div class="paragraph">
<p>Queries may be registered in the system for later execution. They are identified by 'qualified names', i.e. String names that may include a namespace and optionally a formalism type. The following schemes may be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;namespace&gt;::&lt;query-name&gt;</code></p>
</li>
<li>
<p><code>&lt;namespace&gt;::&lt;formalism&gt;::&lt;query-name&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>"ehr::all_influenza_vacc_candidates"</code>     &#8201;&#8212;&#8201;a query for candidates for influenza vaccination</p>
</li>
<li>
<p><code>"demographic::inpatients_rns"</code>            &#8201;&#8212;&#8201;a demographic query for current in-patients of RNS hospital</p>
</li>
<li>
<p><code>"task_planning::aql::chemotherapy_plans"</code> &#8201;&#8212;&#8201;an AQL query for chemotherapy plans</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no namespace is supplied, the namespace <code>"misc"</code> is assumed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_2"><a class="anchor" href="#_class_definitions_2"></a>4.4. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_definition_adl2_interface"><a class="anchor" href="#_i_definition_adl2_interface"></a>4.4.1. I_DEFINITION_ADL2 Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_DEFINITION_ADL2</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface to ADL2 definitions (i.e. models) in an EHR 'system'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_artefact</strong> (<br>
an_id: <code>ARCHETYPE_HRID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if AOM2 artefact with id <code><em>an_id</em></code> exists in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>valid_artefact</strong> (<br>
an_artefact: <code>AUTHORED_ARCHETYPE[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test validity of artefact.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>upload_artefact</strong> (<br>
an_artefact: <code>AUTHORED_ARCHETYPE[1]</code><br>
)<br>
<br>
<em>Pre_valid</em>: <code>valid_artefact (an_arch)</code><br>
<em>Post_has_artefact</em>: <code>has_artefact (an_arch.identifier)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Upload an ADL2 artefact, i.e. archetype, template or operational_template. If an artefact with the same physical identifier and namespace exists, replace it.</p>
</div>
<div class="paragraph">
<p>The artefact must validate.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid artefact</code> (+ specific messages)</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_artefact</strong> (<br>
an_id: <code>ARCHETYPE_HRID[1]</code><br>
): <code>AUTHORED_ARCHETYPE</code><br>
<br>
<em>Pre_artefact_exists</em>: <code>has_artefact (an_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the AOM2 artefact with id <code><em>an_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>artefact_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_artefacts</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_HRID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all AOM2 artefacts known in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_archetypes</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_HRID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all archetypes, i.e. artefacts whose concrete type is <code>AUTHORED_ARCHETYPE</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_templates</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_HRID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all archetypes, i.e. artefacts whose concrete type is <code>TEMPLATE</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_opts</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_HRID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all archetypes, i.e. artefacts whose concrete type is <code>OPERATIONAL_TEMPLATE</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_matching_artefacts</strong> (<br>
id_pattern: <code>String[1]</code>,<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_HRID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all artefacts whose identifiers match a regex pattern.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_id_pattern</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_artefact</strong> (<br>
an_id: <code>ARCHETYPE_HRID[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete the AOM2 artefact with id <code><em>an_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>artefact_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>artefacts_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total artefacts count.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>archetypes_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total archetypes count.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>templates_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total templates count.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>opts_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total OPTs count.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_definition_adl14_interface"><a class="anchor" href="#_i_definition_adl14_interface"></a>4.4.2. I_DEFINITION_ADL14 Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_DEFINITION_ADL14</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface to ADL 1.4 definitions (i.e. archetypes and OPTs) in an EHR 'system'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_archetype</strong> (<br>
an_id: <code>ARCHETYPE_ID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if an ADL 1.4 archetype with id an_id exists in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>valid_archetype</strong> (<br>
an_arch: <code>ARCHETYPE[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test validity of archetype <code><em>an_arch</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>upload_archetype</strong> (<br>
an_arch: <code>ARCHETYPE[1]</code><br>
)<br>
<br>
<em>Post_has_archetype</em>: <code>has_archetype (an_arch.identifier)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Upload a valid ADL 1.4 archetype. If an archetype with the same id already exists, replace it. The archetype must be valid to succeed.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_archetype</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_archetype</strong> (<br>
an_id: <code>ARCHETYPE_ID[1]</code><br>
): <code>ARCHETYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the ADL 1.4 archetype with id an_id.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>artefact_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_archetypes</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all ADL 1.4 archetypes known in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_matching_archetypes</strong> (<br>
id_pattern: <code>String[1]</code>,<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all archetypes whose identifiers match a regex pattern.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_id_pattern</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_archetype</strong> (<br>
an_id: <code>ARCHETYPE_ID[1]</code><br>
)<br>
<br>
<em>Pre_artefact_exists</em>: <code>has_artefact (an_id)</code><br>
<em>Post_archetype_removed</em>: <code>not has_archetype (an_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete a previously uploaded archetype.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_archetype</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_opt</strong> (<br>
an_opt_id: <code>UUID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if ADL 1.4 OPT with id <code><em>an_opt_id</em></code> exists in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>valid_opt</strong> (<br>
an_opt: <code>ARCHETYPE[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test validity of OPT <code><em>an_opt</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>upload_opt</strong> (<br>
an_opt: <code>ARCHETYPE[1]</code><br>
)<br>
<br>
<em>Pre_valid</em>: <code>valid_opt(an_opt)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Upload an ADL 1.4 Operational Template (OPT).</p>
</div>
<div class="ulist">
<div class="title">Errors:</div>
<ul>
<li>
<p><code>invalid_template</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_opt</strong> (<br>
an_opt_id: <code>UUID[1]</code><br>
): <code>ARCHETYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the ADL 1.4 OPT with id <code><em>an_opt_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>artefact_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_opts</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;UUID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all AD 1.4 OPTs known in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_matching_opts</strong> (<br>
id_pattern: <code>String[1]</code>,<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;ARCHETYPE_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all OPTs whose identifiers match a regex pattern.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_id_pattern</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_opt</strong> (<br>
an_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_opt</em>: <code>has_opt (an_id)</code><br>
<em>Post_opt_removed</em>: <code>not has_opt (an_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete a previously uploaded ADL 1.4. OPT.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_template</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>archetypes_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total archetypes count.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>opts_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total OPTs count.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_definition_query_interface"><a class="anchor" href="#_i_definition_query_interface"></a>4.4.3. I_DEFINITION_QUERY Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_DEFINITION_QUERY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for storying queries and query sets.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_query</strong> (<br>
a_query_name: <code>String[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if the query identified by <code><em>a_query_name</em></code> is registered.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_query_name</em></code>
</td>
<td class="hdlist2">
<p>Qualified name of query.</p>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>valid_query</strong> (<br>
a_query_text: <code>String[1]</code>,<br>
a_formalism: <code>String[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if the provided query text is a valid instance of the formalism.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>register_query</strong> (<br>
a_query_text: <code>String[1]</code>,<br>
a_formalism: <code>String[1]</code>,<br>
a_query_name: <code>String[0..1]</code><br>
): <code>QUERY_DESCRIPTOR</code><br>
<br>
<em>Pre_valid_query</em>: <code>is_valid_query(a_query_text)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Register a query under a qualified name. If no name is provided, one is created in the service. Return a Query descriptor containing the query name and unique identifier.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_formalism</em></code>
</td>
<td class="hdlist2">
<p>Case-insensitive name of the formalism of the query text. Values include "AQL" (and "aql").</p>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>register_query_set</strong> (<br>
a_query_set_name: <code>String[0..1]</code><br>
): <code>UUID</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Register a query set.</p>
</div>
<div class="paragraph">
<p>TODO: determine details.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_queries</strong> (<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;QUERY_DESCRIPTOR&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all registered queries.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_matching_queries</strong> (<br>
id_pattern: <code>String[1]</code>,<br>
artefact_id_pattern: <code>String[1]</code>,<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;QUERY_DESCRIPTOR&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List all registered queries matching an identifier pattern (regex) and an artefact identifier pattern (regex) for artefacts referenced in the query. Either pattern may be the regex for 'match any'.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>id_pattern</em></code>
</td>
<td class="hdlist2">
<p>PERL regular expression on query identifier.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>artefact_id_pattern</em></code>
</td>
<td class="hdlist2">
<p>PERL regular expression on archetype / template identifiers.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_id_pattern</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_query</strong> (<br>
a_query_name: <code>String[1]</code><br>
)<br>
<br>
<em>Pre_has_query</em>: <code>has_query(a_query_name)</code><br>
<em>Post_query_deleted</em>: <code>not has_query (a_query_name)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete query with name <code><em>a_query_name</em></code>.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_query_name</em></code>
</td>
<td class="hdlist2">
<p>Qualified query name.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>invalid_query</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>queries_count</strong> (): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return total count of queries.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_definition_call_status_type_enumeration"><a class="anchor" href="#_definition_call_status_type_enumeration"></a>4.4.4. DEFINITION_CALL_STATUS_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DEFINITION_CALL_STATUS_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Enumeration representing call statuses for <code>DEFINITION</code> service interface calls.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid_archetype</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An invalid archetype was provided as a parameter.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid_template</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An invalid template was provided as a parameter.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid_artefact</p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid_query</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An invalid query was provided as a parameter.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid_id_pattern</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An invalid archetype identifier regex pattern was provided.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">artefact_does_not_exist</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A provided archetype identifier does not exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">template_does_not_exist</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A provided template identifier does not exist.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_query_descriptor_class"><a class="anchor" href="#_query_descriptor_class"></a>4.4.5. QUERY_DESCRIPTOR Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>QUERY_DESCRIPTOR</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Object describing a query in terms of its unique identifier, name under which it is currently registered and registration time under the current name.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>qualified_query_name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Unique qualified name of query. Qualified names follow patterns such as <code>&lt;namespace&gt;::&lt;query_name&gt;</code></p>
</div>
<div class="paragraph">
<p>e.g. "ehr::all_over_50_women".</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>version</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Query semver.org version number.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>registration_time</strong>: <code>Iso8601_date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Time query was registered in the service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>formalism</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Formalism of the query, matching one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"aql";</p>
</li>
<li>
<p>any other string value.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>source</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Source query text to be executed (prior to parameter substitution).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ehr_package"><a class="anchor" href="#_ehr_package"></a>5. EHR Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_4"><a class="anchor" href="#_overview_4"></a>5.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.ehr</code> package shown below defines service interface to the <code>EHR</code> component in the logical platform architecture.</p>
</div>
<div id="sm_platform_interface_ehr" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.ehr.svg" alt="SM platform interface.ehr">
</div>
<div class="title">Figure 6. <code>sm.openehr_platform.platform_interface.ehr</code> package</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_3"><a class="anchor" href="#_class_definitions_3"></a>5.2. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_ehr_service_interface"><a class="anchor" href="#_i_ehr_service_interface"></a>5.2.1. I_EHR_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Primary interface to <code>EHR_SERVICE</code> persistent repository.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_ehr</strong> (<br>
ehr_id: <code>UUID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if a EHR with identifier <code><em>ehr_id</em></code> exists.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>ehr_id</em></code>
</td>
<td class="hdlist2">
<p>EHR identifier.</p>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_ehr_for_subject</strong> (<br>
a_subject_id: <code>PARTY_REF[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Returns True if there are EHR(s) for <code><em>a_subject_id</em></code>.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_subject_id</em></code>
</td>
<td class="hdlist2">
<p>Subject identifier.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_ehr</strong> (<br>
an_ehr_status: <code>EHR_STATUS[0..1]</code><br>
): <code>UUID</code><br>
<br>
<em>Post_has_ehr</em>: <code>has_ehr (Result)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create a new EHR with a system-generated identifier and return the id.</p>
</div>
<div class="paragraph">
<p>If the <code><em>an_ehr_status</em></code> parameter is provided, it is created as the EHR&#8217;s <code>EHR_STATUS</code>, otherwise a default <code>EHR_STATUS</code> is created, in which <code><em>is_modifiable</em></code> and <code><em>is_queryable</em></code> are both True.</p>
</div>
<div class="paragraph">
<p>A default <code><em>subject</em></code> will be generating containing a <code>PARTY_SELF</code> object.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_ehr_with_id</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
an_ehr_status: <code>EHR_STATUS[0..1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_no_duplicate</em>: <code>not has_ehr (an_ehr_id)</code><br>
<em>Post_has_ehr</em>: <code>has_ehr (Result)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create a new EHR with a provided EHR id; return the id as a safety check.</p>
</div>
<div class="paragraph">
<p>If the <code><em>an_ehr_status</em></code> parameter is provided, it is created as the EHR&#8217;s <code>EHR_STATUS</code>, otherwise a default <code>EHR_STATUS</code> is created, in which <code><em>is_modifiable</em></code> and <code><em>is_queryable</em></code> are both True.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>an_ehr_id</em></code>
</td>
<td class="hdlist2">
<p>EHR identifier (a UUID).</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_create_fail_duplicate_id</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A default <code><em>subject</em></code> will be generating containing a <code>PARTY_SELF</code> object.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_ehr_for_subject</strong> (<br>
a_subject_id: <code>PARTY_REF[1]</code>,<br>
an_ehr_status: <code>EHR_STATUS[0..1]</code><br>
): <code>UUID</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create a new EHR with <code>EHR_STATUS.<em>subject</em></code> set to point to <code><em>subject_id</em></code>, and return its EHR id.</p>
</div>
<div class="paragraph">
<p>If the <code><em>an_ehr_status</em></code> parameter is provided, it is created as the EHR&#8217;s <code>EHR_STATUS</code>, otherwise a default <code>EHR_STATUS</code> is created, in which <code><em>is_modifiable</em></code> and <code><em>is_queryable</em></code> are both True.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_subject_id</em></code>
</td>
<td class="hdlist2">
<p>Subject identifier.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_for_subject_already_exists</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_ehr_for_subject_with_id</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_subject_id: <code>PARTY_REF[1]</code>,<br>
an_ehr_status: <code>EHR_STATUS[0..1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_no_duplicate</em>: <code>not has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create a new EHR with EHR id and provided subject id. Return the EHR id as a safety check.</p>
</div>
<div class="paragraph">
<p>If the <code><em>an_ehr_status</em></code> parameter is provided, it is created as the EHR&#8217;s <code>EHR_STATUS</code>, otherwise a default <code>EHR_STATUS</code> is created, in which <code><em>is_modifiable</em></code> and <code><em>is_queryable</em></code> are both True.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>an_ehr_id</em></code>
</td>
<td class="hdlist2">
<p>EHR identifier (a UUID).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>a_subject_id</em></code>
</td>
<td class="hdlist2">
<p>Subject identifier.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_create_fail_duplicate_id</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_ehr</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
): <code>EHR_SUMMARY</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieve a summarised form of the EHR root object and <code>EHR_STATUS</code>.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>an_ehr_id</em></code>
</td>
<td class="hdlist2">
<p>EHR identifier (a UUID).</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_ehrs_for_subject</strong> (<br>
a_subject_id: <code>PARTY_REF[1]</code><br>
): <code>List&lt;EHR_SUMMARY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieve EHR or EHRs that have <code><em>ehr_status.subject_id</em></code> = supplied subject id.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_subject_id</em></code>
</td>
<td class="hdlist2">
<p>Subject identifier.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>esubject_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>i_ehr</strong> (<br>
ehr_id: <code>UUID[1]</code><br>
): <code>I_EHR</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Provide access to an <code>I_EHR</code> interface instance for access to the parts of an EHR.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_ehr_interface"><a class="anchor" href="#_i_ehr_interface"></a>5.2.2. I_EHR Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for single patient EHR-level operations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ehr_status</strong>: <code>I_EHR_STATUS</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Access to <code>I_EHR_STATUS</code> interface.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>directory</strong>: <code>I_EHR_DIRECTORY</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Access to <code>I_EHR_DIRECTORY</code> interface.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>compositions</strong>: <code>I_EHR_COMPOSITION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Access to <code>I_EHR_COMPOSITION</code> interface.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>contributions</strong>: <code>I_EHR_CONTRIBUTION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Access to <code>I_EHR_CONTRIBUTION</code> interface.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_ehr_status_interface"><a class="anchor" href="#_i_ehr_status_interface"></a>5.2.3. I_EHR_STATUS Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_STATUS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface to <code>EHR_STATUS</code> of an EHR, with implicit Contribution creation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_ehr_status_version</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>UUID[1]</code><br>
): <code>Boolean</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>True if <code><em>an_ehr_status_ver_uid</em></code> is one of the versions of this versioned EHR Status object.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_ehr_status</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
): <code>EHR_STATUS</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the current version of the <code>EHR_STATUS</code> object for an EHR.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_ehr_status_at_time</strong> (<br>
a_time: <code>Iso8601_date_time[0..1]</code><br>
): <code>EHR_STATUS</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the version of the EHR Status extant at time <code><em>a_time</em></code>. If no time supplied, get the latest.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>set_ehr_queryable</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Post_is_queryable_set</em>: <code>get_ehr_status(an_ehr_id).is_queryable</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set the EHR <code><em>is_queryable</em></code> flag to true; this ensures it is included by the query engine.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>set_ehr_modifiable</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Post_is_modifiable_set</em>: <code>get_ehr_status(an_ehr_id).is_modifiable</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set the EHR <code><em>is_modifable</em></code> flag to true; this ensures it is treated as active and updatable.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clear_ehr_queryable</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Post_is_queryable_cleared</em>: <code>not get_ehr_status(an_ehr_id).is_queryable</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clear the EHR <code><em>is_queryable</em></code> flag; this ensures it is ignored by the query engine.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clear_ehr_modifiable</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Post_is_modifiable_cleared</em>: <code>not get_ehr_status(an_ehr_id).is_modifiable</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clear the EHR <code><em>is_modifiable</em></code> flag; this ensures it is treated as active.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_other_details</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_details: <code>ITEM_TREE[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update other_details part of <code>EHR_STATUS</code> with new content.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_ehr_status_at_version</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>UUID[1]</code><br>
): <code>EHR_STATUS</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get a particular version of an EHR Status object.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_versioned_ehr_status</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
): <code>VERSIONED_EHR_STATUS</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_has_ehr_status_version</em>: <code>has_ehr_status_version (an_ehr_id, a_version_uid)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the <code>VERSIONED_EHR_STATUS</code> object from the EHR with id <code><em>ehr_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_ehr_directory_interface"><a class="anchor" href="#_i_ehr_directory_interface"></a>5.2.4. I_EHR_DIRECTORY Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_DIRECTORY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Operations on EHR directory, with implicit Contribution creation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_directory</strong> (<br>
ehr_id: <code>UUID[1]</code><br>
): <code>Boolean</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>True if the EHR has a directory structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_path</strong> (<br>
ehr_id: <code>UUID[1]</code>,<br>
a_path: <code>String[1]</code><br>
): <code>Boolean</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>True if path <code><em>a_path</em></code> exists in directory. The <code><em>a_path</em></code> argument consists of slash-separated values of the name attribute of Folders in the directory.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_directory</strong> (<br>
ehr_id: <code>UUID[1]</code>,<br>
a_dir_struct: <code>UV_FOLDER[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_definitions_valid</em>: <code>definitions_valid (a_dir_struct)</code><br>
<em>Pre_no_directory</em>: <code>not has_directory (ehr_id)</code><br>
<em>Pre_content_valid</em>: <code>valid_content(a_dir_struct)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create a directory in the EHR, based on the provided structure.  Causes server-side creation of a new <code>VERSIONED_OBJECT</code>, <code>ORIGINAL_VERSION</code> and new <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_directory</strong> (<br>
ehr_id: <code>UUID[1]</code><br>
): <code>FOLDER</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get current version of EHR Directory structure, if it exists, else Void.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_directory_at_time</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_time: <code>Iso8601_date_time[0..1]</code><br>
): <code>FOLDER</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the version of the Directory extant at time <code><em>a_time</em></code>. If no time supplied, get the latest.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_time</em></code>
</td>
<td class="hdlist2">
<p>Time specifying the extant top version of the Directory.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_directory</strong> (<br>
ehr_id: <code>UUID[1]</code>,<br>
a_dir_struct: <code>UV_FOLDER[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_definitions_valid</em>: <code>definitions_valid (a_dir_struct)</code><br>
<em>Pre_content_valid</em>: <code>valid_content(a_dir_struct)</code><br>
<em>Pre_has_directory</em>: <code>has_directory(ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create or update a directory from a complete structure. Preceding version must be supplied and correct if EHR directory already exists. Causes server-side creation of a new <code>ORIGINAL_VERSION</code> and a new <code>CONTRIBUTION</code>.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_dir_struct</em></code>
</td>
<td class="hdlist2">
<p>Directory structure with which to replace current structure.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_directory</strong> (<br>
ehr_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_has_directory</em>: <code>has_directory(ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Logically delete the directory by creating a new version in which the contents are removed.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_directory_version</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>UUID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>True if the directory has a version with specified id.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_directory_at_version</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>UUID[1]</code><br>
): <code>FOLDER</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get a particular version of the EHR Directory.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>version_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_versioned_directory</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
): <code>VERSIONED_FOLDER</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the <code>VERSIONED_FOLDER</code> Directory object for the EHR with <code><em>ehr_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_ehr_composition_interface"><a class="anchor" href="#_i_ehr_composition_interface"></a>5.2.5. I_EHR_COMPOSITION Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_COMPOSITION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for commit and retrieve of Compositions, with implicit Contribution creation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_composition</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>OBJECT_VERSION_ID[1]</code><br>
): <code>Boolean</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if a Composition version with identifier <code><em>a_version_uid</em></code> exists.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_composition_latest</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_versioned_object_uid: <code>UUID[1]</code><br>
): <code>COMPOSITION</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_has_composition</em>: <code>has_composition (an_ehr_id, a_version_uid)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieve the latest version of a Composition.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_versioned_object_uid</em></code>
</td>
<td class="hdlist2">
<p>Uid of the <code>VERSIONED_COMPOSITION</code>.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>composition_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_composition_at_time</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_versioned_object_uid: <code>UUID[1]</code>,<br>
a_time: <code>Iso8601_date_time[0..1]</code><br>
): <code>COMPOSITION</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieve the Composition version extant at a given time, from a Versioned Composition. If no time supplied, get the latest.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>composition_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_composition_at_version</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>OBJECT_VERSION_ID[1]</code><br>
): <code>COMPOSITION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get a particular Version of a Composition by version id.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_does_not_exist</code></p>
</li>
<li>
<p><code>object_version_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_versioned_composition</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_versioned_object_uid: <code>UUID[1]</code><br>
): <code>VERSIONED_COMPOSITION</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieve the <code>VERSIONED_OBJECT</code> of a Composition by uid.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>versioned_composition_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_composition</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_comp: <code>UV_COMPOSITION[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_composition_definitions_valid</em>: <code>definitions_valid (a_comp)</code><br>
<em>Pre_content_valid</em>: <code>valid_content (a_comp)</code><br>
<em>Post_has_composition</em>: <code>has_composition (an_ehr_id, Result)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create the first version of a new Composition. Causes server-side creation of a new <code>VERSIONED_OBJECT</code>, <code>ORIGINAL_VERSION</code> and new <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>composition_already_exists</code></p>
</li>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_composition</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_comp: <code>UV_COMPOSITION[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_composition_definitions_valid</em>: <code>definitions_valid (a_comp)</code><br>
<em>Pre_content_valid</em>: <code>valid_content (a_comp)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update an existing Composition, which includes server-side creation of a new <code>ORIGINAL_VERSION</code> and a new <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>composition_does_not_exist</code></p>
</li>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_composition</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_version_uid: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Logically delete a Composition by creating a new version in which the content is removed and the lifecycle state is set to <code>523&#124;deleted&#124;</code>. The <code><em>a_version_uid</em></code> argument identifies the current top Composition Version.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>composition_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_ehr_contribution_interface"><a class="anchor" href="#_i_ehr_contribution_interface"></a>5.2.6. I_EHR_CONTRIBUTION Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_CONTRIBUTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for explicit Contribution level operations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_contribution</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_contrib_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if the Contribution with <code><em>a_contrib_id</em></code> in EHR with id <code><em>an_ehr_id</em></code> exists.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_contribution</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_contrib_id: <code>UUID[1]</code><br>
): <code>CONTRIBUTION</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Pre_has_contribution</em>: <code>has_contribution (a_contrib_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return the Contribution with id <code><em>a_contrib_id</em></code> in EHR with id <code><em>an_ehr_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
<li>
<p><code>contribution_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>commit_contribution</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
versions: <code>List&lt;UPDATE_VERSION&gt;[1]</code>,<br>
an_audit: <code>UPDATE_AUDIT[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code><br>
<em>Post_has_contribution</em>: <code>has_contribution (a_contrib_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit a <code>CONTRIBUTION</code> containing any number of <code>UPDATE_VERSION</code> objects.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_contributions</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
time_range: <code>Interval&lt;Iso8601_date_time&gt;[0..1]</code>,<br>
item_offset: <code>Integer[0..1]</code>,<br>
items_to_fetch: <code>Integer[0..1]</code><br>
): <code>List&lt;UUID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain a list of identifiers of Contributions in EHR.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>time_range</em></code>
</td>
<td class="hdlist2">
<p>Optional time range to limit Contributions to.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>contribution_count</strong> (<br>
ehr_id: <code>UUID[1]</code>,<br>
time_range: <code>Interval&lt;Iso8601_date_time&gt;[0..1]</code><br>
): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain a count of Contributions in EHR.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>ehr_id</em></code>
</td>
<td class="hdlist2">
<p>EHR identifier (Guid).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>time_range</em></code>
</td>
<td class="hdlist2">
<p>Optional time range to limit Contributions count to.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_ehr_summary_class"><a class="anchor" href="#_ehr_summary_class"></a>5.2.7. EHR_SUMMARY Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EHR_SUMMARY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Summary form of <code>EHR</code> + <code>EHR_STATUS</code> objects convenient for use in service interface.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ehr_id</strong>: <code>UUID</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>EHR identifier of this EHR.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Copy of <code>EHR.<em>system_id</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ehr_status</strong>: <code>EHR_STATUS</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Copy of <code>EHR.<em>ehr_status</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time_created</strong>: <code>Iso8601_date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Copy of <code>EHR.<em>time_created</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>contribution_count</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Number of Contributions in this EHR.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>composition_count</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Number of (versioned) Compositions in this EHR.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demographic_package"><a class="anchor" href="#_demographic_package"></a>6. Demographic Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_5"><a class="anchor" href="#_overview_5"></a>6.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.demographic</code> package shown below defines service interface to the <code>DEMOGRAPHIC_SERVICE</code> component in the logical platform architecture.</p>
</div>
<div id="platform_interface_demographic" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.demographic.svg" alt="SM platform interface.demographic">
</div>
<div class="title">Figure 7. <code>sm.openehr_platform.platform_interface.demographic</code> package</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_4"><a class="anchor" href="#_class_definitions_4"></a>6.2. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_demographic_service_interface"><a class="anchor" href="#_i_demographic_service_interface"></a>6.2.1. I_DEMOGRAPHIC_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_DEMOGRAPHIC_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Primary interface to <code>DEMOGRAPHIC_SERVICE</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_party</strong> (<br>
a_version: <code>UV_PARTY[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_party_definitions_valid</em>: <code>definitions_valid (a_version)</code><br>
<em>Pre_content_valid</em>: <code>valid_content (a_version)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create the first version of a new <code>PARTY</code> object. Causes server-side creation of a new <code>VERSIONED_OBJECT</code>, <code>ORIGINAL_VERSION</code> and new <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_party_relationship</strong> (<br>
a_version: <code>UV_PARTY_RELATIONSHIP[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_content_valid</em>: <code>valid_content (a_version)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create the first version of a new <code>PARTY_RELATIONSHIP</code>. Causes server-side creation of a new <code>VERSIONED_OBJECT</code>, <code>ORIGINAL_VERSION</code> and new <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>i_party</strong> (<br>
a_versioned_party_id<br>
): <code>I_PARTY</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create an <code>I_PARTY</code> interface.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>i_party_relationship</strong> (<br>
a_versioned_party_rel_id<br>
): <code>I_PARTY_RELATIONSHIP</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create an <code>I_PARTY_RELATIONSHIP</code> interface.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_party_interface"><a class="anchor" href="#_i_party_interface"></a>6.2.2. I_PARTY Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_PARTY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for <code>PARTY</code> level operations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_party</strong> (<br>
a_versioned_party_id: <code>UUID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if Party exists.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_party_version_id</strong> (<br>
a_party_version_id: <code>UUID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>True if a particular version of a Party exists.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_party</strong> (<br>
a_versioned_party_id: <code>UUID[1]</code><br>
): <code>PARTY</code><br>
<br>
<em>Pre_has_party</em>: <code>has_party (a_versioned_party_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the current Version of a Party.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_party_at_time</strong> (<br>
a_versioned_party_id: <code>UUID[1]</code>,<br>
a_time: <code>Iso8601_date_time[1]</code><br>
): <code>PARTY</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the Version of a Party current at <code><em>a_time</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_party</strong> (<br>
a_versioned_party_id: <code>UUID[1]</code>,<br>
a_version: <code>UV_PARTY[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_party_definitions_valid</em>: <code>definitions_valid (a_version)</code><br>
<em>Pre_has_party</em>: <code>has_party (a_versioned_party_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update a <code>PARTY</code> with a new Version. Causes server-side creation of a new <code>ORIGINAL_VERSION</code> and <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
<li>
<p><code>object_version_does_not_exist</code></p>
</li>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_party</strong> (<br>
a_versioned_party_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_party</em>: <code>has_party (a_versioned_party_id)</code><br>
<em>Post_party_deleted</em>: <code>not has_party (a_versioned_party_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete an existing Party.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_party_at_version</strong> (<br>
a_party_version_id: <code>UUID[1]</code><br>
): <code>PARTY</code><br>
<br>
<em>Pre_has_party_version</em>: <code>has_party_version (a_party_version_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get a particular Party Version.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>object_version_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_party_relationship_interface"><a class="anchor" href="#_i_party_relationship_interface"></a>6.2.3. I_PARTY_RELATIONSHIP Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_PARTY_RELATIONSHIP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for <code>PARTY_RELATIONSHIP</code> operations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>has_party_relationship</strong> (<br>
a_versioned_party_rel_id: <code>UUID[1]</code><br>
): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if Party relationship exists in service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_party_relationship</strong> (<br>
a_versioned_party_rel_id: <code>UUID[1]</code><br>
): <code>PARTY_RELATIONSHIP</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the current Version of a Party relationship.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_party_relationship_at_time</strong> (<br>
a_versioned_party_rel_id: <code>UUID[1]</code>,<br>
a_time: <code>Iso8601_date_time[1]</code><br>
): <code>PARTY_RELATIONSHIP</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get the Version of a Party relationship current at <code><em>a_time</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_party_relationship</strong> (<br>
a_versioned_party_rel_id: <code>UUID[1]</code>,<br>
a_version: <code>UV_PARTY_RELATIONSHIP[1]</code><br>
): <code>UUID</code><br>
<br>
<em>Pre_party_definitions_valid</em>: <code>definitions_valid (a_version)</code><br>
<em>Pre_has_relationship</em>: <code>has_party_relationship (a_versioned_party_rel_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update a <code>PARTY_RELATIONSHIP</code> with a new Version. Causes server-side creation of a new <code>ORIGINAL_VERSION</code> and <code>CONTRIBUTION</code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
<li>
<p><code>object_version_does_not_exist</code></p>
</li>
<li>
<p><code>definition_unknown</code></p>
</li>
<li>
<p><code>content_invalid</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delete_party_relationship</strong> (<br>
a_versioned_party_rel_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_relationship</em>: <code>has_party_relationship (a_versioned_party_rel_id)</code><br>
<em>Post_relationship_deleted</em>: <code>not has_party_relationship (a_versioned_party_rel_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete an existing Party relationship.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>versioned_object_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_party_relationship_at_version</strong> (<br>
a_party_rel_version_id: <code>UUID[1]</code><br>
): <code>PARTY_RELATIONSHIP</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get a particular Party relationship Version.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>object_version_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ehr_index_package"><a class="anchor" href="#_ehr_index_package"></a>7. EHR Index Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_6"><a class="anchor" href="#_overview_6"></a>7.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.ehr_index</code> package shown below defines service interface to the <code>EHR_INDEX</code> component in the logical platform architecture.</p>
</div>
<div id="platform_interface_ehr_index" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.ehr_index.svg" alt="SM platform interface.ehr index">
</div>
<div class="title">Figure 8. <code>sm.openehr_platform.platform_interface.ehr_index</code> package</div>
</div>
<div class="paragraph">
<p>The primary function of the EHR Index service is to enable the recording of associations of subject identifiers (i.e. patient or other subject or care identifiers) with EHR identifiers. In a privacy-supporting environment, this enables EHRs to be persisted with only an EHR id; the EHR Index has to be used to obtain the subject identifier, which will usually be used as a key into a demographic or MPI service, ultimately allowing EHR data to be associated with the correct patient demographic information in a user application.</p>
</div>
<div class="paragraph">
<p>There is no limit on the number of subject identifiers associated with a given EHR id, and vice versa, since in real environments both situations commonly occur. The two cases are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>multiple subject identifiers for one EHR id</em>: indicates that more than one subject of care has data in the same EHR. This is a dangerous error condition, and needs to be detected and rectified.</p>
</li>
<li>
<p><em>multiple EHR ids for a given subject identifier</em>: indicates that multiple EHRs have been created for the same subject, typically as a result of name entry errors, and / or of multiple departments independently creating EHRs rather than locating existing ones for the patient. This is also an error situation, although less dangerous than the inverse situation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enable management of these problems, other meta-data can be associated with each EHR id / subject id association, represented by the <code>RESOURCE_STATUS</code> type.</p>
</div>
<div class="paragraph">
<p>A further useful facility that can be provided by this service is to maintain dynamic location information for EHRs. This is enabled by the inclusion of optional <code>LOCATION_DESC</code> instances with index records.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_5"><a class="anchor" href="#_class_definitions_5"></a>7.2. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_ehr_index_interface"><a class="anchor" href="#_i_ehr_index_interface"></a>7.2.1. I_EHR_INDEX Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_INDEX</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface object for the <code>EHR_INDEX</code> service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>add_ehr_subject</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_subject_id: <code>OBJECT_REF[1]</code>,<br>
a_status: <code>RESOURCE_STATUS[0..1]</code>,<br>
a_loc_desc: <code>LOCATION_DESC[0..1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Add a subject identifier for the EHR with <code><em>an_ehr_id</em></code>, with an optional resource status and location descriptor.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_ehr_subject_status</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_subject_id: <code>OBJECT_REF[1]</code>,<br>
a_status: <code>RESOURCE_STATUS[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update subject resource status for the association of the EHR with <code><em>an_ehr_id</em></code> and subject <code><em>a_subject_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>subject_id_does_not_exist</code></p>
</li>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_ehr_subject_loc_desc</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_subject_id: <code>OBJECT_REF[1]</code>,<br>
a_loc_desc: <code>LOCATION_DESC[0..1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update location descriptor for the association of the EHR with <code><em>an_ehr_id</em></code> and subject <code><em>a_subject_id</em></code>.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>subject_id_does_not_exist</code></p>
</li>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remove_ehr_subject</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
a_subject_id: <code>OBJECT_REF[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Remove the subject identifier association with the EHR with <code><em>an_ehr_id</em></code> (it might remain associated with other EHRs however).</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>subject_id_does_not_exist</code></p>
</li>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remove_subject</strong> (<br>
a_subject_id: <code>OBJECT_REF[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Remove all entries for a subject.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>subject_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_resource_status_class"><a class="anchor" href="#_resource_status_class"></a>7.2.2. RESOURCE_STATUS Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESOURCE_STATUS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Object describing the status of a reference to a resource.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>instance_type</strong>: <code>RESOURCE_INSTANCE_TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Type of resource instance.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_valid_time</strong>:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>First time point at which resource can be assumed to be available.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>end_valid_time</strong>:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Last time point at which resource can be assumed to be available.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>notes</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Human-readable notes on the resource.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_resource_instance_type_enumeration"><a class="anchor" href="#_resource_instance_type_enumeration"></a>7.2.3. RESOURCE_INSTANCE_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESOURCE_INSTANCE_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Enumeration of resource instance types.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Primary instance of the resource.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplicate</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A duplicate instance of the resource.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supplementary</p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_location_desc_class"><a class="anchor" href="#_location_desc_class"></a>7.2.4. LOCATION_DESC Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>LOCATION_DESC</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>A descriptor containing location information for the EHR with which this descriptor is associated.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_query_package"><a class="anchor" href="#_query_package"></a>8. Query Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_7"><a class="anchor" href="#_overview_7"></a>8.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.query</code> package shown below defines service interface to the <code>QUERY_SERVICE</code> component in the logical platform architecture.</p>
</div>
<div id="platform_interface_query" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.query.svg" alt="SM platform interface.query">
</div>
<div class="title">Figure 9. <code>sm.openehr_platform.platform_interface.query</code> package</div>
</div>
<div class="paragraph">
<p>The model of querying here is based on the notion of being able to execute either queries previously stored in the <code>DEFINITION</code> service, or else ad hoc queries. For stored queries, no assumption is made as to whether the query language is AQL (the openEHR default) or something else, only that there are stored queries that can be executed in a standard way.</p>
</div>
<div class="paragraph">
<p>For both kinds of queries, parameters must be provided for open parameters in the stored query.</p>
</div>
<div class="paragraph">
<p>If either type of query executes successfully, the response is a <code>RESULT_SET</code>, which consists of meta-data, a column definition structure and a set of rows (instances of <code>RESULT_SET_ROW</code>). In order to handle large result sets efficiently and gracefully within applications, the parameters <code><em>item_offset</em></code> and <code><em>items_to_fetch</em></code> can be provided to control the result size.</p>
</div>
<div class="paragraph">
<p>A stored query is identified by the identifier associated with it when registered in the <code>DEFINITION</code> service, which is ofthe form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    reverse-domain-name '::' semantic-id [ '/' version ]</pre>
</div>
</div>
<div class="paragraph">
<p>For example: <code>org.example.departmentx.test::diabetes-patient-overview/1.0.2</code>. The optional version enables multiple forms of the same semantic query to co-exist in the service.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_6"><a class="anchor" href="#_class_definitions_6"></a>8.2. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_query_service_interface"><a class="anchor" href="#_i_query_service_interface"></a>8.2.1. I_QUERY_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_QUERY_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Query execution service interface.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execute_stored_query</strong> (<br>
exec_spec: <code>STORED_QUERY_EXECUTE_SPEC[1]</code>,<br>
row_offset: <code>Integer[0..1]</code>,<br>
rows_to_fetch: <code>Integer[0..1]</code>,<br>
ehr_ids: <code>List&lt;UUID&gt;[0..1]</code><br>
): <code>RESULT_SET</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Execute a query stored in the definition service, using its qualified query name. Return a Result set.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>exec_spec</em></code>
</td>
<td class="hdlist2">
<p>Execution specification: which query and optional version to execute, with provided parameters.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>row_offset</em></code>
</td>
<td class="hdlist2">
<p>Optional parameter specifying offset in query response rows to return, used for large result sets. A zero or negative value means offset of zero.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>rows_to_fetch</em></code>
</td>
<td class="hdlist2">
<p>Optional parameter specifying number of query response rows to fetch, used for large result sets. A zero or negative value means 'all'.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>ehr_ids</em></code>
</td>
<td class="hdlist2">
<p>Specific set of EHRs on which to execute the query. If none supplied, a full population query will be performed on all EHRs whose status has the <code><em>is_queryable</em></code> flag set to <code>True</code>.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execute_ad_hoc_query</strong> (<br>
exec_spec: <code>ADHOC_QUERY_EXECUTE_SPEC[1]</code>,<br>
row_offset: <code>Integer[0..1]</code>,<br>
rows_to_fetch: <code>Integer[0..1]</code>,<br>
ehr_ids: <code>List&lt;UUID&gt;[0..1]</code><br>
): <code>RESULT_SET</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Execute an ad hoc query, supplying the query text.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>exec_spec</em></code>
</td>
<td class="hdlist2">
<p>Execution specification: query text to execute, with provided parameters.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>row_offset</em></code>
</td>
<td class="hdlist2">
<p>Optional parameter specifying offset in query response rows to return, used for large result sets. A zero or negative value means offset of zero.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>rows_to_fetch</em></code>
</td>
<td class="hdlist2">
<p>Optional parameter specifying number of query response rows to fetch, used for large result sets. A zero or negative value means 'all'.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>ehr_ids</em></code>
</td>
<td class="hdlist2">
<p>Specific set of EHRs on which to execute the query. If none supplied, a full population query will be performed on all EHRs whose status has the <code><em>is_queryable</em></code> flag set to <code>True</code>.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_stored_query_execute_spec_class"><a class="anchor" href="#_stored_query_execute_spec_class"></a>8.2.2. STORED_QUERY_EXECUTE_SPEC Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>STORED_QUERY_EXECUTE_SPEC</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Class representing query execution specification for stored queries, including name, parameters (where applicable) and optional version.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>qualified_query_name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Qualified name of query, which is of the form <code>reverse_domain::name</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>version</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If supplied, version of the query to execute specified as a semver.org 3-part string. If not supplied, the latest version available will be executed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>query_parameters</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Parameters to substitute in query in the form of a set of tagged String values; each tag must match a parameter name in the query.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_adhoc_query_execute_spec_class"><a class="anchor" href="#_adhoc_query_execute_spec_class"></a>8.2.3. ADHOC_QUERY_EXECUTE_SPEC Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>ADHOC_QUERY_EXECUTE_SPEC</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Class representing query execution specification for ad hoc queries, including query text and parameters (where applicable).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>source</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>AQL text of query.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>formalism</strong>: <code>String<br>
{default&#160;=&#160;"aql"}</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>query_parameters</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Parameters to substitute in query in the form of a set of tagged String values; each tag must match a parameter name in the query.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_result_set_class"><a class="anchor" href="#_result_set_class"></a>8.2.4. RESULT_SET Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESULT_SET</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Structured query execution result. The <code><em>columns</em></code> attribute contains a definition of columns, while the result data is represented by the <code><em>rows</em></code> attribute.</p>
</div>
<div class="paragraph">
<p>Ideally the Result set has sufficient meta-data to be processible independently of the original query.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>columns</strong>: <code>List&lt;RESULT_SET_COLUMN&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Column definition structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Unique identifier of this result set.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>creation_time</strong>: <code>Iso8601_date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Time of creation of this Result set by execution engine.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>query</strong>: <code>RESULT_QUERY_DESCRIPTOR</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rows</strong>: <code>List&lt;RESULT_SET_ROW&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Rox data.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_result_set_column_class"><a class="anchor" href="#_result_set_column_class"></a>8.2.5. RESULT_SET_COLUMN Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESULT_SET_COLUMN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Query column definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Column name for caller to use.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>archetype_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
check on whether needed or inside the path.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>path</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>RM path of data item for this column as specified in query.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_result_set_row_class"><a class="anchor" href="#_result_set_row_class"></a>8.2.6. RESULT_SET_ROW Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESULT_SET_ROW</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Structure representing a single row of output from an executed query.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>values</strong>: <code>List&lt;Any&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List of items corresponding to the columns of the owning Result set.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_message_package"><a class="anchor" href="#_message_package"></a>9. Message Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_8"><a class="anchor" href="#_overview_8"></a>9.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.message</code> package shown below defines service interface to the <code>MESSAGE</code> component in the logical platform architecture.</p>
</div>
<div id="platform_interface_message" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.message.svg" alt="SM platform interface.message">
</div>
<div class="title">Figure 10. <code>sm.openehr_platform.platform_interface.message</code> package</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_7"><a class="anchor" href="#_class_definitions_7"></a>9.2. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_message_service_interface"><a class="anchor" href="#_i_message_service_interface"></a>9.2.1. I_MESSAGE_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_MESSAGE_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Generic message service.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_ehr_extract_service_interface"><a class="anchor" href="#_i_ehr_extract_service_interface"></a>9.2.2. I_EHR_EXTRACT_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_EHR_EXTRACT_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>EHR Extract service; provides interface for importing and exporting <code>EHR_EXTRACTs</code> as defined by the openEHR EHR Extract specification.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>export_ehrs</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
): <code>List&lt;EXTRACT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Export whole EHR for one or more subjects.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>export_ehr_extracts</strong> (<br>
extract_spec: <code>EXTRACT_SPEC[1]</code><br>
): <code>List&lt;EXTRACT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Export an extract for one or more EHRs.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>import_ehr</strong> (<br>
an_ehr_id: <code>UUID[0..1]</code>,<br>
an_extract: <code>EXTRACT[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Import a whole EHR, optionally providing a fixed EHR identifier, which, usually to match the identifier of EHR(s) for the same patient in other EHR services.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>import_ehr_extract</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
an_extract: <code>EXTRACT[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Import an EHR Extract into an existing EHR.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_tdd_service_interface"><a class="anchor" href="#_i_tdd_service_interface"></a>9.2.3. I_TDD_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_TDD_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Template Data Document (TDD) service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>import_tdd</strong> (<br>
an_ehr_id: <code>UUID[1]</code>,<br>
tdd: <code>String[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Import a TDD.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>import_tdds</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Bulk import numerous TDDs.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_admin_package"><a class="anchor" href="#_admin_package"></a>10. Admin Package</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_9"><a class="anchor" href="#_overview_9"></a>10.1. Overview</h3>
<div class="paragraph">
<p>The <code>platform_interface.admin</code> package shown below defines service interface to the <code>ADMIN</code> component in the logical platform architecture.</p>
</div>
<div id="platform_interface_admin" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/SM-platform_interface.admin.svg" alt="SM platform interface.admin">
</div>
<div class="title">Figure 11. <code>sm.openehr_platform.platform_interface.admin</code> package</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_definitions_8"><a class="anchor" href="#_class_definitions_8"></a>10.2. Class Definitions</h3>
<div class="sect3">
<h4 id="_i_admin_service_interface"><a class="anchor" href="#_i_admin_service_interface"></a>10.2.1. I_ADMIN_SERVICE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_ADMIN_SERVICE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Primary <code>ADMIN_SERVICE</code> Interface.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>list_contributions</strong> (<br>
a_service: <code>PLATFORM_SERVICE[1]</code>,<br>
time_interval: <code>Interval&lt;Iso8601_date_time&gt;[0..1]</code><br>
): <code>List&lt;UUID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain a list of ids of all Contributions in EHR system; an optional time range may be supplied.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>a_service</em></code>
</td>
<td class="hdlist2">
<p>Name of a versioned content service (enumeration value).</p>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>contribution_count</strong> (<br>
a_service: <code>PLATFORM_SERVICE[1]</code>,<br>
time_interval: <code>Interval&lt;Iso8601_date_time&gt;[0..1]</code><br>
): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain the count of all Contributions made on EHR system; an optional time range may be supplied.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>versioned_composition_count</strong> (<br>
a_service: <code>PLATFORM_SERVICE[1]</code>,<br>
time_interval: <code>Interval&lt;Iso8601_date_time&gt;[0..1]</code><br>
): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain the count of all Versioned Compositions on EHR system; an optional time range may be supplied.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>composition_version_count</strong> (<br>
a_service: <code>PLATFORM_SERVICE[1]</code>,<br>
time_interval: <code>Interval&lt;Iso8601_date_time&gt;[0..1]</code><br>
): <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain the count of all Composition Versions on EHR system; an optional time range may be supplied.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>physical_ehr_delete</strong> (<br>
an_ehr_id: <code>UUID[1]</code><br>
)<br>
<br>
<em>Pre_has_ehr</em>: <code>has_ehr (an_ehr_id)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Physical deletion of specified EHR.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>physical_party_delete</strong> (<br>
a_party_id: <code>UUID[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Physical delete of specified Party, along with related Party relationships.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>party_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_admin_archive_interface"><a class="anchor" href="#_i_admin_archive_interface"></a>10.2.2. I_ADMIN_ARCHIVE Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_ADMIN_ARCHIVE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface for Archive-related functions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>archive_ehrs</strong> (<br>
ehr_ids: <code>List&lt;UUID&gt;[0..1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Move selected EHRs to archival storage.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>ehr_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>archive_parties</strong> (<br>
party_ids: <code>List&lt;UUID&gt;[0..1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Move selected Parties and relationships to archival storage.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>party_id_does_not_exist</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_admin_dump_load_interface"><a class="anchor" href="#_i_admin_dump_load_interface"></a>10.2.3. I_ADMIN_DUMP_LOAD Interface</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_ADMIN_DUMP_LOAD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Interface to dump/load facilities.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>export_ehrs</strong> (<br>
file_sys_loc: <code>String[1]</code>,<br>
logical_fmt: <code>EXPORT_FORMAT[0..1]</code>,<br>
comp_fmt: <code>COMPRESSION_FORMAT[0..1]</code>,<br>
enc_format: <code>ENCODING_FORMAT[0..1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Export all EHRs to a file-system location in a specified format.</p>
</div>
<div class="hdlist">
<div class="title">Parameters<br></div>
<table>
<tr>
<td class="hdlist1">
<code><em>file_sys_loc</em></code>
</td>
<td class="hdlist2">
<p>File system location to write archive to.</p>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>file_not_writable</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>load_ehrs</strong> (<br>
file_sys_loc: <code>String[1]</code><br>
)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Populate EHR repository from export archive on file system. Repository need not be empty, but import EHRs with duplicate EHR ids will fail.</p>
</div>
<div class="ulist">
<div class="title">Errors</div>
<ul>
<li>
<p><code>file_not_writable</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dump_load_fail_report_class"><a class="anchor" href="#_dump_load_fail_report_class"></a>10.2.4. DUMP_LOAD_FAIL_REPORT Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DUMP_LOAD_FAIL_REPORT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Dump or Load fail report for a single entity, e.g. <code>EHR</code>, <code>PARTY</code> etc .</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entity_type</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Type name of entity.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entity_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Identifier of entity.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dump_status</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Status of entity in dump operation: <code>True</code> means successfully dumped; <code>False</code> means dump failed for this entity.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>error</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Detailed error information, if available.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_export_spec_class"><a class="anchor" href="#_export_spec_class"></a>10.2.5. EXPORT_SPEC Class</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXPORT_SPEC</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specifies the details for an export operation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>logical_format</strong>: <code>EXPORT_FORMAT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Logical format to use, i.e. flavour of XML, JSON etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>compression_format</strong>: <code>COMPRESSION_FORMAT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Compression format to use during dump.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>encoding</strong>: <code>ENCODING_FORMAT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Encoding to use.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>segment_split_size</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Size in kb of segment size on file system to split export into.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-03-04 21:02:43 UTC
</div>
</div>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-murphy.css">
</body>
</html>